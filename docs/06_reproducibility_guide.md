# 06_reproducibility_guide.md (Unified Style Version)
# 1. Reproducibility Guide

This section describes how to reconstruct the **Autoimmune Somatic Variant Database (autoimmune_db)** from source using version-controlled migrations and curated seed files.

The database is fully reproducible from the public GitHub repository and can be rebuilt independently using MySQL and PHP.

---

## 2. Reference Version

This guide corresponds to the Git release tag:

**v0.3-summary-enhancement**

All schema definitions, analytical views, and curated data described in this document reflect that tagged release.

To reproduce the exact version:

```bash
git clone https://github.com/sdukda/autoimmune-somatic-variant_db.git
cd autoimmune-somatic-variant_db
git checkout v0.3-summary-enhancement
```
## 3. System Requirements

The following software is required:

MySQL 8.0+

PHP 8+

Git

Web server (Apache, Nginx, or PHP built-in server)

Optional tools for development:

Sequel Ace or MySQL Workbench

VS Code, Vim, or Nano

## 4.  Repository Structure

The repository is organised as follows:

autoimmune_db/
├── docs/
├── sql/
│   ├── migrations/
│   ├── seeds/
│   └── migrations_archive/
├── ui/
│   ├── public/
│   └── config/
└── README.md


Key points:

Schema definitions are stored in sql/migrations/

Curated data files are stored in sql/seeds/

The web interface is located in ui/public/

Documentation files are stored in docs/

## 5.  Database Reconstruction

**Step 1 – Create the Database**
CREATE DATABASE autoimmune_db
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_unicode_ci;

**Step 2 – Apply Migration Files**

Run migration scripts in numeric order:

mysql -u root -p autoimmune_db < sql/migrations/001_create_all_tables.sql
...
mysql -u root -p autoimmune_db < sql/migrations/053_update_v_literature_summary_by_variant_coords_add_id.sql

These scripts define:

Core entity tables (gene, disease, study, variant, cell_type)

Foreign key constraints

Indexes and unique constraints

Analytical views (e.g., v_literature_variants_flat)

Snapshot preservation logic

**Step 3 – Load Seed Data**
mysql -u root -p autoimmune_db < sql/seeds/001_seed_core_lookups.sql
...
mysql -u root -p autoimmune_db < sql/seeds/021_stage_literature_data.sql


Seed files populate:

Reference genomes

Disease ontology identifiers (DOID)

Cell ontology identifiers (CL)

Literature-curated somatic variants

Evidence classifications

## 6. Application Configuration

Create the file:

ui/config/db.local.php


Example configuration:

return [
  'host' => '127.0.0.1',
  'dbname' => 'autoimmune_db',
  'user' => 'root',
  'pass' => 'your_password'
];


This file is excluded from version control for security.

## 7.  Launching the Portal

Start a local PHP server:

php -S 127.0.0.1:8080 -t ui/public


Open in browser:

http://127.0.0.1:8080

## 8.  ERD and Schema Alignment

The database schema was designed using an Entity–Relationship Diagram (ERD) prior to implementation.

The ERD served as the conceptual blueprint for relational schema construction and ensured normalization and referential integrity.

![Entity-Relationship Diagram](.images/ERD_autoimmune_db_v0.3.png)
Figure 12. Entity–Relationship Diagram of the autoimmune_db schema (v0.3).

The schema generated by executing the migration scripts at tag v0.3-summary-enhancement is structurally identical to this ERD.

## 9.  Validation Checklist

After setup, confirm the following:

Variants Page

Variants display correctly

Sorting functions properly

Filtering works

CSV download works

Variant Detail Page

Evidence rows display correctly

Protein changes are visible

Genomic coordinates link to UCSC

PMID links to PubMed

Gene Page

Gene summary displays correctly

Associated diseases appear

Disease Page

Disease ontology ID is displayed

Linked studies are correct

Study Page

Study metadata is visible

Variant counts are accurate

## 10.  Data Provenance and Traceability

Each curated variant record includes:

Study reference

Paper-reported reference genome

Lifted genomic coordinates

Disease ontology mapping (DOID)

Cell ontology mapping (CL)

Driver interpretation

Evidence type

No variant exists without:

Study linkage

Disease context

Curation record

## 11. Version Control and Reproducibility

Reproducibility is ensured through:

Ordered SQL migrations

Version-controlled seed files

Snapshot preservation tables

Referential integrity constraints

No manual UI-based edits to core tables

The database can be rebuilt identically at any specific Git commit or tagged release.

## 12.  Scientific Reproducibility Statement

The autoimmune_db system is:

Literature-driven

Ontology-mapped

Genome-build aware

Fully version-controlled

Reconstructible from curated CSV source files

It represents a reproducible computational research asset suitable for academic dissemination.
